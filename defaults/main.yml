---
# adduser.conf template location.
adduser_conf_template: "etc/adduser.conf.j2"

# Modifies the AIDE C(Checksums) variable.
aide_checksums: "sha512"

# AIDE directories to exclude from checks.
aide_dir_exclusions: ["/var/lib/docker", "/var/lib/lxcfs", "/var/lib/private/systemd", "/var/log/audit", "/var/log/journal"]
# Allow virtual system calls (vsyscall).
allow_virtual_system_calls: true

# AppArmor sysctl settings.
apparmor_sysctl_settings:
  kernel.apparmor_display_secid_mode: 0 # If 1, AppArmor will provide a human-readable mapping of internal security IDs.
  kernel.apparmor_restrict_unprivileged_io_uring: 0 # If 1, restrict unprivileged io_uring operations.
  kernel.apparmor_restrict_unprivileged_unconfined: 1 # If 1, enforces extra security restrictions on unprivileged unconfined processes.
  kernel.apparmor_restrict_unprivileged_userns: 1 # If 1, restricts unprivileged user namespaces.
  kernel.apparmor_restrict_unprivileged_userns_complain: 0 # If 1, unprivileged user namespaces will be put into complain mode.
  kernel.apparmor_restrict_unprivileged_userns_force: 0 # If 1, all confined applications will have the user namespace mediation enforced.
  kernel.unprivileged_userns_apparmor_policy: 1 # If 1, unprivileged user namespaces will be restricted to the AppArmor policy.

# Options used to configure the APT suite of tools.
apt_hardening_options:
  - 'Acquire::AllowDowngradeToInsecureRepositories "false";'
  - 'Acquire::AllowInsecureRepositories "false";'
  - 'Acquire::http::AllowRedirect "false";'
  - 'APT::Get::AllowUnauthenticated "false";'
  - 'APT::Get::AutomaticRemove "true";'
  - 'APT::Install-Recommends "false";'
  - 'APT::Install-Suggests "false";'
  - 'APT::Periodic::AutocleanInterval "7";'
  - 'APT::Sandbox::Seccomp "1";'
  - 'Unattended-Upgrade::Remove-Unused-Dependencies "true";'
  - 'Unattended-Upgrade::Remove-Unused-Kernel-Packages "true";'
# This option should contain a valid email address or alias.
auditd_action_mail_acct: "root"

# This parameter tells the system what action to take when the system has detected that it is starting to get low on disk space.
auditd_admin_space_left_action: "suspend"

# If True, the role applies the auditd rules from the included template file.
auditd_apply_audit_rules: true

# This parameter tells the system what action to take whenever there is an error detected when writing audit events to disk or rotating logs.
auditd_disk_error_action: "suspend"

# This parameter tells the system what action to take when the system has detected that the partition to which log files are written has become full.
auditd_disk_full_action: "suspend"

# Set enabled flag for auditd service.
auditd_enable_flag: 2

# When to flush the audit records to disk.
auditd_flush: "incremental_async"

# If True, the audit daemon will ignore errors when reading rules from a file.
auditd_ignore_errors: false

# This keyword specifies the maximum file size in megabytes. When this limit is reached, it will trigger a configurable action.
auditd_max_log_file: 20

# This parameter tells the system what action to take when the system has detected that the max file size limit has been reached.
auditd_max_log_file_action: "rotate"

# Set failure mode.
auditd_mode: 1

# Specifies the number of log files to keep if rotate is given as the max_log_file_action.
auditd_num_logs: 5

# If the free space in the filesystem containing log_file drops below this value (in megabytes), the audit daemon takes the action specified by space_left_action.
auditd_space_left: 75

# This parameter tells the system what action to take when the system has detected that it is starting to get low on disk space.
auditd_space_left_action: "email"

# Configure automatic updates.
automatic_updates:
  enabled: true # If True, install and configure C(dnf-automatic) or C(unattended-upgrades), depending on the distribution.
  only_security: true # If True, only security updates will be installed automatically.
  reboot: false # If True, it will reboot the system if needed.
  reboot_from_time: "2:00" # If system reboot is enabled, the variable sets the reboot time, with added random minutes from C(reboot_time_margin_mins).
  reboot_time_margin_mins: 20 # Add minutes to the reboot time, set using C(reboot_from_time).
  custom_origins: "" # Add custom origins to unattended upgrades through a list of strings. For Debian it is "origin=<ORIGIN>,archive=<ARCHIVE>". For Ubuntu it is "<ORIGIN>:<ARCHIVE>".

# PAM common-account template location.
common_account_template: "etc/pam.d/common-account.j2"

# PAM common-auth template location.
common_auth_template: "etc/pam.d/common-auth.j2"

# PAM common-password template location.
common_password_template: "etc/pam.d/common-password.j2"

# Compilers to restrict to the root user.
compilers: ["as", "cargo", "cc", "cc-[0-9]*", "clang-[0-9]*", "gcc", "gcc-[0-9]*", "go", "make", "rustc"]
# Connection tracking sysctl settings.
conntrack_sysctl_settings:
  net.netfilter.nf_conntrack_max: 2000000 # The maximum number of connections that the system’s connection tracking table can hold at any time.
  net.netfilter.nf_conntrack_tcp_loose: 0 # If 0, the system will not allow TCP connections to be established without a SYN packet.

# systemd coredump.conf template location.
coredump_conf_template: "etc/systemd/coredump.conf.j2"

# The cryptographic policy to set if C(set_crypto_policy: true).
crypto_policy: "DEFAULT:NO-SHA1"

# List of users to delete.
delete_users: ["games", "gnats", "irc", "list", "news", "sync", "uucp"]
# If True, disable the C(Apport) crash reporting system.
disable_apport: true

# Disable the Ctrl+Alt+Del key combination to reboot the system.
disable_ctrlaltdel: true

# If True, disable IPv6 on the system.
disable_ipv6: false

# Disable prelinking of binaries.
disable_prelink: true

# If True, disable the root account.
disable_root_account: true

# If True, turn off all wireless interfaces.
disable_wireless: false

# A list of addresses to use as system DNS servers.
dns: ["1.1.1.2", "9.9.9.9"]
# Set the DNS over TLS mode for systemd-resolved.
dns_over_tls: "opportunistic"

# Set the DNSSEC mode for systemd-resolved.
dnssec: "allow-downgrade"

# Enable kernel page poisoning.
enable_page_poisoning: true

# Faillock configuration options.
faillock:
  admin_group: "" # Members of the group will be handled the same as the root account
  audit: true # Will log the user name into the system log if the user is not found
  deny: 5 # Deny access if the number of login failures exceeds the value of this option.
  dir: "/var/run/faillock" # Where the user files with the failure records are kept.
  even_deny_root: true # Root account can become locked as well as regular accounts.
  fail_interval: 900 # The length of the interval during which the consecutive authentication failures must happen for the user account to lock out.
  local_users_only: true # Only track failed user authentications attempts for local users in /etc/passwd.
  no_log_info: false # Don't log informative messages via syslog(3).
  nodelay: true # Don't enforce a delay after authentication failures.
  root_unlock_time: 600 # Allow access after N seconds to root account after the account is locked.
  silent: false # Don't print informative messages to the user.
  unlock_time: 600 # Allow access after N seconds to user accounts after the account is locked.

# faillock.conf template location.
faillock_conf_template: "etc/security/faillock.conf.j2"

# A list of addresses to use as the fallback DNS servers.
fallback_dns: ["1.0.0.2", "149.112.112.112"]
# A list of NTP server host names or IP addresses to be used as the fallback NTP servers.
fallback_ntp: ["ntp.netnod.se", "ntp.ubuntu.com"]
# Filesystem kernel modules to block and blacklist.
fs_modules_blocklist: ["cramfs", "freevxfs", "hfs", "hfsplus", "jffs2", "squashfs", "udf"]
# Generic sysctl settings.
generic_sysctl_settings:
  fs.protected_fifos: 2 # Avoid unintentional writes to an attacker-controlled FIFO, where a program expected to create a regular file.
  fs.protected_regular: 2 # Avoid unintentional writes to an attacker-controlled regular file, where a program expected to create one.
  fs.protected_hardlinks: 1 # Restrict hard links to files that are not owned by the user.
  fs.protected_symlinks: 1 # Restrict symbolic links to files that are not owned by the user.
  fs.suid_dumpable: 0 # Set the core dump mode for setuid or otherwise protected/tainted binaries.
  kernel.core_pattern: "|/bin/false" # Specify a core dumpfile pattern name.
  kernel.core_uses_pid: 1 # If 1, the core dump file name will include the PID of the process that created it.
  kernel.dmesg_restrict: 1 # If 1, unprivileged users are prevented from using dmesg to view messages from the kernel’s log buffer.
  kernel.kptr_restrict: 2 # Whether restrictions are placed on exposing kernel addresses via /proc and other interfaces.
  kernel.panic: 60 # The value in this file determines the behaviour of the kernel on a panic.
  kernel.panic_on_oops: 1 # If 1, Panic immediately. If the panic sysctl is also non-zero then the machine will be rebooted.
  kernel.perf_event_paranoid: 2 # Controls use of the performance events system by unprivileged users.
  kernel.randomize_va_space: 2 # Select the type of process address space randomization that is used in the system.
  kernel.sysrq: 0 # If 1, the magic SysRq key is enabled.
  kernel.unprivileged_bpf_disabled: 1 # Controls whether BPF programs are disabled for unprivileged users.
  kernel.unprivileged_userns_clone: 0 # Controls whether unprivilegd users can create user namespaces.
  kernel.yama.ptrace_scope: 2 # Select which processes can be debugged with ptrace.
  net.core.bpf_jit_harden: 2 # Level of hardening applied to the BPF JIT compiler.
  user.max_user_namespaces: 0 # The maximum number of user namespaces that can be created by a user.

# Set the audit backlog limit in the GRUB command line.
grub_audit_backlog_cmdline: "audit_backlog_limit=8192"

# Enable auditd in the GRUB command line.
grub_audit_cmdline: "audit=1"

# auditd rules template location.
hardening_rules_template: "etc/audit/rules.d/hardening.rules.j2"

# This option controls who can access the information in C(/proc/pid) directories
hide_pid: 2

# /etc/hosts.allow template location.
hosts_allow_template: "etc/hosts.allow.j2"

# /etc/hosts.deny template location.
hosts_deny_template: "etc/hosts.deny.j2"

# profile initpath.sh template location.
initpath_sh_template: "etc/profile.d/initpath.sh.j2"

# IPv4 sysctl settings.
ipv4_sysctl_settings:
  net.ipv4.conf.all.accept_redirects: 0 # If 0, the system does not accept IPv4 redirects.
  net.ipv4.conf.all.accept_source_route: 0 # If 0, deny IPv4 source routing.
  net.ipv4.conf.all.log_martians: 1 # If 1, log packets with un-routable source addresses to the kernel log.
  net.ipv4.conf.all.rp_filter: 1 # Set the reverse path filtering mode for all interfaces.
  net.ipv4.conf.all.secure_redirects: 1 # If 1, accept ICMP redirect messages only to gateways listed in the interface's current gateway list. Overridden by shared_media.
  net.ipv4.conf.all.send_redirects: 0 # If 0, the system does not send ICMP redirect messages.
  net.ipv4.conf.all.shared_media: 1 # If 1, indicates that the media is shared with different subnets, overrides secure_redirects.
  net.ipv4.conf.default.accept_redirects: 0 # If 0, the system does not accept IPv4 redirects on the default interface.
  net.ipv4.conf.default.accept_source_route: 0 # If 0, deny IPv4 source routing on the default interface.
  net.ipv4.conf.default.log_martians: 1 # If 1, log packets with un-routable source addresses to the kernel log on the default interface.
  net.ipv4.conf.default.rp_filter: 1 # Set the reverse path filtering mode for the default interface.
  net.ipv4.conf.default.secure_redirects: 1 # If 1, accept ICMP redirect messages only to gateways listed in the interface's current gateway list on the default interface. Overridden by shared_media.
  net.ipv4.conf.default.send_redirects: 0 # net.ipv4.conf.default.send_redirects description
  net.ipv4.conf.default.shared_media: 1 # If 1, indicates that the media is shared with different subnets, overrides secure_redirects on the default interface.
  net.ipv4.icmp_echo_ignore_broadcasts: 1 # If 1, the system ignores ICMP echo requests sent to broadcast addresses.
  net.ipv4.icmp_ignore_bogus_error_responses: 1 # If 1, the system ignores bogus ICMP responses.
  net.ipv4.ip_forward: 0 # If 1, the system forwards IPv4 packets between interfaces.
  net.ipv4.tcp_challenge_ack_limit: 2147483647 # Set the TCP challenge ACK limit.
  net.ipv4.tcp_invalid_ratelimit: 500 # The maximal rate for sending duplicate acknowledgments in response to incoming TCP packets, in milliseconds.
  net.ipv4.tcp_max_syn_backlog: 20480 # The number of SYN requests the kernel can queue before it starts dropping them.
  net.ipv4.tcp_rfc1337: 1 # If 1, the system will not accept TCP connections that are vulnerable to the TCP sequence number attack described in RFC 1337.
  net.ipv4.tcp_syn_retries: 5 # Number of times initial SYNs for an active TCP connection attempt will be retransmitted. Should not be higher than 127.
  net.ipv4.tcp_synack_retries: 5 # Number of times SYNACKs for a passive TCP connection attempt will be retransmitted. Should not be higher than 255.
  net.ipv4.tcp_syncookies: 1 # If 1, the system will use TCP SYN cookies to protect against SYN flood attacks.
  net.ipv4.tcp_timestamps: 1 # Enable timestamps as defined in RFC1323.

# IPv6 sysctl settings to disable IPv6.
ipv6_disable_sysctl_settings:
  net.ipv6.conf.all.disable_ipv6: 1 # If 1, the system disables IPv6 on all interfaces.
  net.ipv6.conf.default.disable_ipv6: 1 # If 1, the system disables IPv6 on the default interface.

# IPv6 sysctl settings.
ipv6_sysctl_settings:
  net.ipv6.conf.all.accept_ra: 0 # If 0, the system does not accept IPv6 router advertisements.
  net.ipv6.conf.all.accept_redirects: 0 # If 0, the system does not accept IPv6 redirects.
  net.ipv6.conf.all.accept_source_route: 0 # If 0, deny forwarding of IPv6 Source Routed Packets
  net.ipv6.conf.all.forwarding: 0 # If 0, denies IPv6 forwarding.
  net.ipv6.conf.all.use_tempaddr: 2 # Preference for IPv6 Privacy Extensions on all interfaces.
  net.ipv6.conf.default.accept_ra: 0 # If 0, the system does not accept IPv6 router advertisements on the default interface.
  net.ipv6.conf.default.accept_ra_defrtr: 0 # If 0, the system does not accept default routers from IPv6 router advertisements on the default interface.
  net.ipv6.conf.default.accept_ra_pinfo: 0 # If 0, the system does not accept prefix information from IPv6 router advertisements on the default interface.
  net.ipv6.conf.default.accept_ra_rtr_pref: 0 # If 0, the system does not accept router preference from IPv6 router advertisments on the default interface.
  net.ipv6.conf.default.accept_redirects: 0 # If 0, the system does not accept IPv6 redirects on the default interface.
  net.ipv6.conf.default.accept_source_route: 0 # If 0, deny forwarding of IPv6 Source Routed Packets on the default interface.
  net.ipv6.conf.default.autoconf: 0 # If 0, the system doesn't autoconfigure addresses using Prefix Information in Router Advertisements.
  net.ipv6.conf.default.dad_transmits: 0 # The amount of Duplicate Address Detection probes to send.
  net.ipv6.conf.default.max_addresses: 1 # Maximum number of autoconfigured IPv6 addresses per interface.
  net.ipv6.conf.default.router_solicitations: 0 # Number of Router Solicitations to send until assuming no routers are present.
  net.ipv6.conf.default.use_tempaddr: 2 # Preference for IPv6 Privacy Extensions on the default interface.

# /etc/issue template location.
issue_template: "etc/issue.j2"

# If True, journal files will be compressed.
journald_compress: true

# systemd journald.conf template location.
journald_conf_template: "etc/systemd/journald.conf.j2"

# If True, forward journal messages to syslog.
journald_forwardtosyslog: false

# The group that has access to the journal files.
journald_group: "systemd-journal"

# Sets the permissions for journal files and directories.
journald_permissions: "2640"

# Controls where to store journal data.
journald_storage: "persistent"

# How much disk space the journal may use up at most.
journald_system_max_use: ""

# The user that has access to the journal files.
journald_user: "root"

# Configures kernel_lockdown.
kernel_lockdown: false

# Maximum number of open files, hard resource limit
limit_nofile_hard: 1024

# Maximum number of open files, soft resource limit
limit_nofile_soft: 512

# Maximum number of processes, hard resource limit
limit_nproc_hard: 1024

# Maximum number of processes, soft resource limit
limit_nproc_soft: 512

# limits.conf template location.
limits_conf_template: "etc/security/limits.conf.j2"

# login.defs configuration options.
login_defs:
  home_mode: "0700" # The permissions assigned to a newly created user's home directory.
  login_retries: 5 # Maximum number of login retries in case of bad password.
  login_timeout: 60 # Max time in seconds for login.
  pass_max_days: 60 # The maximum number of days a password may be used. If the password is older than this, a password change will be forced.
  pass_min_days: 1 # The minimum number of days allowed between password changes. If a user tries to change their password before this time, the change will be denied.
  pass_warn_age: 7 # The number of days before password expiration that the user will be warned about the impending expiration.
  usergroups_enabled: true # If True, userdel will remove the user's group if it's empty, and useradd will create by default a group with the name of the user. It also modifies the UMASK default value for private user groups.

# /etc/login.defs template location.
login_defs_template: "etc/login.defs.j2"

# login template location
login_template: "etc/pam.d/login.j2"

# Configure systemd-logind settings.
logind:
  killuserprocesses: true # Configures whether the processes of a user should be killed when the user logs out.
  killexcludeusers: ["root"] # A list of usernames that override the KillUserProcesses setting.
  idleaction: "lock" # Configures the action to take when the system is idle.
  idleactionsec: "15min" # Configures the delay after which the action configured in C(IdleAction) is taken after the system is idle.
  removeipc: true # Controls whether System V and POSIX IPC objects belonging to the user shall be removed when the user fully logs out.

# systemd logind.conf template location.
logind_conf_template: "etc/systemd/logind.conf.j2"

# logrotate.conf template location.
logrotate_conf_template: "etc/logrotate.conf.j2"

# If True, the role will configure C(adduser) and C(useradd) using the available templates.
manage_adduser_conf: true

# If True, manage AIDE installation and configuration.
manage_aide: true

# If True, manage C(AppArmor) installation and configuration.
manage_apparmor: true

# If True, then the Linux Audit System will configured and enabled at boot using GRUB.
manage_auditd: true

# If True, then the listed compilers will restricted to the root user.
manage_compilers: true

# If True, then C(at) and C(cron) will be restricted to the root user.
manage_cron: true

# If True, enable and manage faillock.
manage_faillock: true

# If True, then any floppy devices will be removed from C(/etc/fstab).
manage_fstab: true

# If True, manage C(/etc/hosts.allow) and C(/etc/hosts.deny) configuration.
manage_hosts: true

# If True, then C(/etc/issue), C(/etc/issue.net) and C(/etc/motd) will be replaced with the available templates.
manage_issue: true

# If True, manage C(systemd-journald) installation and configuration.
manage_journal: true

# If True, then additional kernel settings will be configured.
manage_kernel: true

# If True, then the listed modules will be blocked and blacklisted.
manage_kernel_modules: true

# If True, manage system limits.
manage_limits: true

# If True, then manage C(/etc/login.defs) configuration.
manage_login_defs: true

# If True, then the systemd-logind service will be configured using the available template.
manage_logind: true

# If True, then C(apt-news), C(motd-news) and Ubuntu Pro will be disabled.
manage_motdnews: true

# If True, C(/proc) will be mounted with the C(nosuid,nodev,noexec,hidepid) options, C(/dev/shm) will be mounted with the C(nosuid,nodev,noexec) options and C(/tmp) will be mounted as tmpfs with the C(nosuid,nodev,noexec) options using the available template.
manage_mounts: true

# If True, then any available netplan configuration files will have the permissions set to 0600.
manage_netplan: true

# If True, then C(apt) and C(dnf) will be configured to use for example GPG verification and clean requirements on remove.
manage_package_managers: true

# If True, then the role will install the packages listed in C(packages_debian), C(packages_redhat) and C(packages_ubuntu).
manage_packages: true

# If True, manage PAM configuration files.
manage_pam: true

# Manage PAM and various password settings.
manage_password: true

# If True, then the C(PATH) variable will be set in C(/etc/environment) and C(/etc/profile.d/initpath.sh) will be created.
manage_path: true

# If True, then the Postfix mail server will be configured if C(/etc/postfix/main.cf) exists.
manage_postfix: true

# If True, enable and manage pwquality.
manage_pwquality: true

# If True, then the systemd-resolved service will be installed and configured.
manage_resolved: true

# If True, manage rkhunter installation and configuration.
manage_rkhunter: true

# If True, then the root user will only be able to login using a console and the systemd debug-shell will be masked.
manage_root_access: true

# If True, manage OpenSSH client and server configuration.
manage_ssh: true

# If True, then manage sudo configuration.
manage_sudo: true

# If True, remove suid and sgid permissions on the binaries listed in suid_sgid_blocklist.
manage_suid_sgid_permissions: true

# If True, manage C(sysctl) settings.
manage_sysctl: true

# If True, then the role will configure /etc/systemd/system.conf and /etc/systemd/user.conf using the available templates.
manage_systemd: true

# If True, manage systemd-timesyncd installation and configuration.
manage_timesyncd: true

# If True, manage C(UFW) installation and configuration.
manage_ufw: true

# If True, manage C(USBGuard) installation and configuration.
manage_usbguard: true

# If True, then the listed users will be removed and any home directories will have the permissions set to 0750.
manage_users: true

# Misc kernel modules to block and blacklist.
misc_modules_blocklist:
  - "bluetooth"
  - "bnep"
  - "btusb"
  - "can"
  - "cpia2"
  - "firewire-core"
  - "floppy"
  - "ksmbd"
  - "n_hdlc"
  - "net-pf-31"
  - "pcspkr"
  - "soundcore"
  - "thunderbolt"
  - "usb-midi"
  - "usb-storage"
  - "uvcvideo"
  - "v4l2_common"
# /etc/motd template location.
motd_template: "etc/motd.j2"

# Network kernel modules to block and blacklist.
net_modules_blocklist: ["atm", "dccp", "sctp", "rds", "tipc"]
# A list of NTP server host names or IP addresses to be used as the primary NTP servers.
ntp: ["2.pool.ntp.org", "time.nist.gov"]
# Packages that will be removed from the system if they are installed.
packages_blocklist:
  - "apport"
  - "autofs"
  - "avahi"
  - "beep"
  - "ftp"
  - "git"
  - "inetutils-telnet"
  - "pastebinit"
  - "popularity-contest"
  - "prelink"
  - "rpcbind"
  - "rsh"
  - "rsh-server"
  - "rsync"
  - "talk"
  - "telnet"
  - "telnet-server"
  - "tftp"
  - "tftpd"
  - "tnftp"
  - "tuned"
  - "vsftpd"
  - "whoopsie"
  - "xinetd"
  - "yp-tools"
  - "ypbind"
# Packages to install on Debian-based systems.
packages_debian:
  - "acct"
  - "apparmor-profiles"
  - "apparmor-utils"
  - "apt-listchanges"
  - "apt-show-versions"
  - "audispd-plugins"
  - "auditd"
  - "cracklib-runtime"
  - "curl"
  - "debsums"
  - "gnupg2"
  - "libpam-apparmor"
  - "libpam-cap"
  - "libpam-modules"
  - "libpam-tmpdir"
  - "lsb-release"
  - "needrestart"
  - "openssh-server"
  - "postfix"
  - "rsyslog"
  - "sysstat"
  - "systemd-journal-remote"
  - "tcpd"
  - "vlock"
  - "wamerican"
# Packages to install on Red Hat-based systems.
packages_redhat:
  - "audispd-plugins"
  - "audit"
  - "cracklib"
  - "curl"
  - "gnupg2"
  - "openssh-server"
  - "needrestart"
  - "postfix"
  - "psacct"
  - "python3-dnf-plugin-post-transaction-actions"
  - "rsyslog"
  - "rsyslog-gnutls"
  - "systemd-journal-remote"
  - "vlock"
  - "words"
# Packages to install on Ubuntu-based systems.
packages_ubuntu: ["fwupd", "secureboot-db", "snapd"]
# Enable page table isolation (PTI).
page_table_isolation: true

# The number of previous passwords to remember and not allow the user to reuse.
password_remember: 24

# Specifies the ID of a group whose members are authorized to learn process information otherwise prohibited by hidepid.
process_group: 0

# pwquality configuration options.
pwquality:
  dcredit: -1 # The maximum credit for having digits in the new password.
  dictcheck: true # Check whether the password matches a word in a dictionary.
  dictpath: "" # The path to the dictionary file used for password strength checking.
  difok: 8 # The number of characters that must be different between the new password and the old one.
  enforce_for_root: true # The module will return error on failed check even if the user changing the password is root.
  enforcing: true # Reject the password if it fails the checks, otherwise only print the warning.
  gecoscheck: true # Check whether the password matches a word in the GECOS field of the user account.
  lcredit: -1 # The maximum credit for having lowercase letters in the new password.
  local_users_only: true # The module will not test the password quality for users that are not present in the C(/etc/passwd) file.
  maxclassrepeat: 4 # Reject passwords which contain more than N consecutive characters of the same class.
  maxrepeat: 3 # Reject passwords which contain more than N consecutive characters.
  maxsequence: 3 # Reject passwords which contain monotonic character sequences longer than N.
  minclass: 4 # The minimum number of character classes that must be present in the new password.
  minlen: 15 # The minimum length of the new password.
  ocredit: -1 # This is the maximum credit for having other characters in the new password.
  retry: 3 # The number of times the user is allowed to retry entering a password that passes the checks.
  ucredit: -1 # The maximum credit for having uppercase letters in the new password.
  usercheck: true # Check whether the password (with possible modifications) contains the user name in some form.
  usersubstr: 3 # Check whether the password contains a substring of at least N length

# pwquality.conf template location.
pwquality_conf_template: "etc/security/pwquality.conf.j2"

# If True, an Ubuntu node will be rebooted if required.
reboot_ubuntu: false

# systemd resolved.conf template location.
resolved_conf_template: "etc/systemd/resolved.conf.j2"

# If the SSH protocol version 1 is allowed.
rkhunter_allow_ssh_prot_v1: false

# If the root user is allowed to login via SSH.
rkhunter_allow_ssh_root_user: false

# Which mirrors are to be used for rkhunter updates.
rkhunter_mirrors_mode: 0

# rkhunter configuration template location.
rkhunter_template: "etc/default/rkhunter.j2"

# If True,  the mirrors file is to be checked for updates as well.
rkhunter_update_mirrors: true

# The command to use for downloading files from the Internet.
rkhunter_web_cmd: "curl -fsSL"

# Set the file creation mode for rsyslog log files.
rsyslog_filecreatemode: "0640"

# Sets, in seconds, the TMOUT environment variable if systemd version is 252 or lower. If version 252 or higher, the session_timeout value will be set as StopIdleSessionSec.
session_timeout: 900

# Set and use cryptographic policies if C(/etc/crypto-policies/config) exists and C(set_crypto_policy: true).
set_crypto_policy: true

# Enable SLUB debugger poisoning.
slub_debugger_poisoning: false

# OpenSSH ssh_config template location.
ssh_config_template: "etc/ssh/ssh_config.j2"

# Specifies what environment variables sent by the client will be copied into the session.
sshd_accept_env: "LANG LC_*"

# Only the network(s) defined in C(sshd_admin_net) are allowed to connect to C(sshd_ports).
sshd_admin_net: ["192.168.0.0/24", "192.168.1.0/24"]
# Specifies whether ssh-agent forwarding is permitted.
sshd_allow_agent_forwarding: false

# If specified, login is allowed only for users whose primary group or supplementary group list matches one of the patterns.
sshd_allow_groups: ["sudo"]
# Specifies whether TCP forwarding is permitted.
sshd_allow_tcp_forwarding: false

# If specified, login is allowed only for users whose user name matches one of the patterns.
sshd_allow_users: []
# The authentication methods that must be successfully completed in order to grant access to a user.
sshd_authentication_methods: "any"

# Specifies a file that lists principal names that are accepted for certificate authentication.
sshd_authorized_principals_file: "/etc/ssh/auth_principals/%u"

# The contents of the specified file are sent to the remote user before authentication.
sshd_banner: "/etc/issue.net"

# Specifies which algorithms are allowed for signing of certificates by certificate authorities.
sshd_ca_signature_algorithms: ["ecdsa-sha2-nistp384", "ecdsa-sha2-nistp521", "ssh-ed25519", "rsa-sha2-512"]
# Specifies the ciphers allowed. Multiple ciphers must be comma-separated.
sshd_ciphers: ["chacha20-poly1305@openssh.com", "aes256-gcm@openssh.com", "aes256-ctr"]
# Sets the number of client alive messages which may be sent without sshd receiving any messages back from the client.
sshd_client_alive_count_max: 1

# Sets a timeout interval in seconds after which if no data has been received from the client, sshd will send a message channel to request a response from the client.
sshd_client_alive_interval: 200

# Specifies whether compression is enabled.
sshd_compression: false

# Clear pre-existing custom configurations in /etc/ssh/sshd_config.d
sshd_config_d_force_clear: false

# Force replace configuration file C(/etc/ssh/sshd_config).
sshd_config_force_replace: false

# OpenSSH sshd_config template location.
sshd_config_template: "etc/ssh/sshd_config.j2"

# Specifies whether the distribution-specified extra version suffix is included during initial protocol handshake.
sshd_debian_banner: false

# Login is disallowed for users whose primary group or supplementary group list matches one of the patterns.
sshd_deny_groups: []
# Login is disallowed for users whose user name matches one of the patterns.
sshd_deny_users: []
# Specifies whether remote hosts are allowed to connect to ports forwarded for the client.
sshd_gateway_ports: false

# Specifies whether user authentication based on GSSAPI is allowed.
sshd_gssapi_authentication: false

# Specifies the host key algorithms that the server offers.
sshd_host_key_algorithms:
  - "ssh-ed25519-cert-v01@openssh.com"
  - "ssh-rsa-cert-v01@openssh.com"
  - "ssh-ed25519"
  - "ecdsa-sha2-nistp521-cert-v01@openssh.com"
  - "ecdsa-sha2-nistp384-cert-v01@openssh.com"
  - "ecdsa-sha2-nistp521"
  - "ecdsa-sha2-nistp384"
# Specifies a file containing a private host key used by SSH. If empty C(RSA), C(ECDSA), and C(ED25519) will be used, if supported by the installed sshd version.
sshd_host_keys_files: []
# Owner group of the host keys.
sshd_host_keys_group: "root"

# Host keys file mode.
sshd_host_keys_mode: "0600"

# Owner of the host keys.
sshd_host_keys_owner: "root"

# Specifies whether rhosts or /etc/hosts.equiv authentication together with successful public key client host authentication is allowed.
sshd_hostbased_authentication: false

# Specifies that .rhosts and .shosts files will not be used in HostbasedAuthentication.
sshd_ignore_rhosts: true

# Specifies whether sshd should ignore the user's ~/.ssh/known_hosts during HostbasedAuthentication and use only the system-wide known hosts file /etc/ssh/known_hosts.
sshd_ignore_user_known_hosts: true

# Specifies whether to allow keyboard-interactive authentication.
sshd_kbd_interactive_authentication: false

# Specifies whether the password provided by the user for PasswordAuthentication will be validated through the Kerberos KDC.
sshd_kerberos_authentication: false

# Specifies the available KEX (Key Exchange) algorithms.
sshd_kex_algorithms:
  - "curve25519-sha256@libssh.org"
  - "diffie-hellman-group16-sha512"
  - "diffie-hellman-group18-sha512"
  - "ecdh-sha2-nistp521"
  - "ecdh-sha2-nistp384"
# Specifies the addresses sshd should listen on.
sshd_listen: ["0.0.0.0"]
# Gives the verbosity level that is used when logging messages from sshd.
sshd_log_level: "verbose"

# The server disconnects after this time if the user has not successfully logged in.
sshd_login_grace_time: 20

# Specifies the available MAC (Message Authentication Code) algorithms.
sshd_macs: ["hmac-sha2-512-etm@openssh.com", "hmac-sha2-256-etm@openssh.com", "hmac-sha2-512", "hmac-sha2-256"]
# Add a conditional block for addresses. If all of the criteria on the Match line are satisfied, the rules/parameters defined override those set in the global section of the config file, until either another Match line or the end of the file.
sshd_match_addresses: []
# Add a conditional block for groups. If all of the criteria on the Match line are satisfied, the rules/parameters defined override those set in the global section of the config file, until either another Match line or the end of the file.
sshd_match_groups: []
# Add a conditional block for ports. If all of the criteria on the Match line are satisfied, the rules/parameters defined override those set in the global section of the config file, until either another Match line or the end of the file.
sshd_match_local_ports: []
# Add a conditional block for users. If all of the criteria on the Match line are satisfied, the rules/parameters defined override those set in the global section of the config file, until either another Match line or the end of the file.
sshd_match_users: []
# Specifies the maximum number of authentication attempts permitted per connection.
sshd_max_auth_tries: 3

# Specifies the maximum number of open sessions permitted per network connection.
sshd_max_sessions: 3

# Specifies the maximum number of concurrent unauthenticated connections to the SSH daemon.
sshd_max_startups: "10:30:60"

# Specifies whether password authentication is allowed.
sshd_password_authentication: false

# Specifies whether the server allows login to accounts with empty password strings.
sshd_permit_empty_passwords: false

# Specifies whether root can log in using ssh, if True then the option is set to prohibit-password.
sshd_permit_root_login: false

# Specifies whether tun device forwarding is allowed.
sshd_permit_tunnel: false

# Specifies whether user environment variables are processed by sshd.
sshd_permit_user_environment: false

# Specifies the port number that sshd listens on.
sshd_ports: [22]
# Specifies whether sshd should print the last user login when a user logs in interactively.
sshd_print_last_log: true

# Specifies whether sshd should print /etc/motd when a user logs in interactively.
sshd_print_motd: false

# Specifies whether pam_motd should be enabled for sshd.
sshd_print_pam_motd: false

# Specifies the maximum amount of data that may be transmitted before the session key is renegotiated, optionally followed a maximum amount of time that may pass before the session key is renegotiated.
sshd_rekey_limit: "512M 1h"

# Required ECDSA key size when generating new host keys.
sshd_required_ecdsa_size: 521

# Required RSA key size when generating new host keys.
sshd_required_rsa_size: 4096

# Specifies whether the SFTP subsystem should chroot users.
sshd_sftp_chroot: true

# Specifies the pathname of a directory to chroot to after authentication.
sshd_sftp_chroot_dir: "%h"

# Specifies whether the SFTP subsystem should be enabled.
sshd_sftp_enabled: true

# Specifies the name of the group that will have access restricted to the sftp service only.
sshd_sftp_only_group: ""

# Specifies the SFTP subsystem to use.
sshd_sftp_subsystem: "internal-sftp -f LOCAL6 -l INFO"

# Specifies whether sshd should check file modes and ownership of the user's files and home directory before accepting login.
sshd_strict_modes: true

# Gives the facility code that is used when logging messages from sshd.
sshd_syslog_facility: "auth"

# Specifies whether the system should send TCP keepalive messages to the other side.
sshd_tcp_keep_alive: false

# OpenSSH tmpfiles template location.
sshd_tmpfiles_template: "usr/lib/tmpfiles.d/ssh.conf.j2"

# Public keys of trusted certificate authoritites in base64 format.
sshd_trusted_user_ca_keys_base64: ""

# Specifies a file containing public keys of certificate authorities that are trusted to sign user certificates for authentication.
sshd_trusted_user_ca_keys_file: "/etc/ssh/trusted-user-ca-keys.pem"

# Specifies whether the moduli file should be updated.
sshd_update_moduli: false

# Specifies the URL to download the moduli file from.
sshd_update_moduli_url: "https://raw.githubusercontent.com/konstruktoid/ssh-moduli/main/moduli"

# Specifies whether sshd should look up the remote host name, and to check that the resolved host name for the remote IP address maps back to the very same IP address.
sshd_use_dns: false

# If true, this will enable PAM authentication using KbdInteractiveAuthentication and PasswordAuthentication in addition to PAM account and session module processing for all authentication types.
sshd_use_pam: true

# Specifies whether sshd separates privileges by creating an unprivileged child process to deal with incoming network traffic.
sshd_use_privilege_separation: "sandbox"

# Specifies whether X11 forwarding is permitted.
sshd_x11_forwarding: false

# List of binaries to remove suid and sgid permissions from.
suid_sgid_blocklist:
  - "7z"
  - "aa-exec"
  - "ab"
  - "agetty"
  - "alpine"
  - "ansible-playbook"
  - "ansible-test"
  - "aoss"
  - "apache2ctl"
  - "apt"
  - "apt-get"
  - "ar"
  - "aria2c"
  - "arj"
  - "arp"
  - "as"
  - "ascii-xfr"
  - "ascii85"
  - "ash"
  - "aspell"
  - "at"
  - "atobm"
  - "awk"
  - "aws"
  - "base32"
  - "base58"
  - "base64"
  - "basenc"
  - "basez"
  - "bash"
  - "batcat"
  - "bc"
  - "bconsole"
  - "bpftrace"
  - "bridge"
  - "bsd-write"
  - "bundle"
  - "bundler"
  - "busctl"
  - "busybox"
  - "byebug"
  - "bzip2"
  - "c89"
  - "c99"
  - "cabal"
  - "cancel"
  - "capsh"
  - "cat"
  - "cdist"
  - "certbot"
  - "chage"
  - "check_by_ssh"
  - "check_cups"
  - "check_log"
  - "check_memory"
  - "check_raid"
  - "check_ssl_cert"
  - "check_statusfile"
  - "chfn"
  - "chmod"
  - "choom"
  - "chown"
  - "chroot"
  - "chsh"
  - "clamscan"
  - "cmp"
  - "cobc"
  - "column"
  - "comm"
  - "composer"
  - "cowsay"
  - "cowthink"
  - "cp"
  - "cpan"
  - "cpio"
  - "cpulimit"
  - "crash"
  - "crontab"
  - "csh"
  - "csplit"
  - "csvtool"
  - "cupsfilter"
  - "curl"
  - "cut"
  - "dash"
  - "date"
  - "dc"
  - "dd"
  - "debugfs"
  - "dialog"
  - "diff"
  - "dig"
  - "distcc"
  - "dmesg"
  - "dmidecode"
  - "dmsetup"
  - "dnf"
  - "docker"
  - "dos2unix"
  - "dosbox"
  - "dotnet"
  - "dpkg"
  - "dstat"
  - "dvips"
  - "easy_install"
  - "eb"
  - "ed"
  - "efax"
  - "elvish"
  - "emacs"
  - "enscript"
  - "env"
  - "eqn"
  - "espeak"
  - "ex"
  - "exiftool"
  - "expand"
  - "expect"
  - "facter"
  - "file"
  - "find"
  - "finger"
  - "fish"
  - "flock"
  - "fmt"
  - "fold"
  - "fping"
  - "ftp"
  - "fusermount"
  - "gawk"
  - "gcc"
  - "gcloud"
  - "gcore"
  - "gdb"
  - "gem"
  - "genie"
  - "genisoimage"
  - "ghc"
  - "ghci"
  - "gimp"
  - "ginsh"
  - "git"
  - "grc"
  - "grep"
  - "gtester"
  - "gzip"
  - "hd"
  - "head"
  - "hexdump"
  - "highlight"
  - "hping3"
  - "iconv"
  - "iftop"
  - "install"
  - "ionice"
  - "ip"
  - "irb"
  - "ispell"
  - "jjs"
  - "joe"
  - "join"
  - "journalctl"
  - "jq"
  - "jrunscript"
  - "jtag"
  - "julia"
  - "knife"
  - "ksh"
  - "ksshell"
  - "ksu"
  - "kubectl"
  - "latex"
  - "latexmk"
  - "ld.so"
  - "ldconfig"
  - "less"
  - "lftp"
  - "links"
  - "ln"
  - "loginctl"
  - "logsave"
  - "look"
  - "lp"
  - "ltrace"
  - "lua"
  - "lualatex"
  - "luatex"
  - "lwp-download"
  - "lwp-request"
  - "mail"
  - "make"
  - "man"
  - "mawk"
  - "minicom"
  - "mksh"
  - "mksh-static"
  - "mlocate"
  - "more"
  - "mosquitto"
  - "mount"
  - "mount.nfs"
  - "msfconsole"
  - "msgattrib"
  - "msgcat"
  - "msgconv"
  - "msgfilter"
  - "msgmerge"
  - "msguniq"
  - "mtr"
  - "multitime"
  - "mv"
  - "mysql"
  - "nano"
  - "nasm"
  - "nawk"
  - "nc"
  - "ncdu"
  - "ncftp"
  - "neofetch"
  - "netfilter-persistent"
  - "newgrp"
  - "nft"
  - "nice"
  - "nl"
  - "nm"
  - "nmap"
  - "node"
  - "nohup"
  - "npm"
  - "nroff"
  - "nsenter"
  - "ntfs-3g"
  - "ntpdate"
  - "octave"
  - "od"
  - "openssl"
  - "openvpn"
  - "openvt"
  - "opkg"
  - "pandoc"
  - "paste"
  - "pax"
  - "pdb"
  - "pdflatex"
  - "pdftex"
  - "perf"
  - "perl"
  - "perlbug"
  - "pexec"
  - "pg"
  - "php"
  - "pic"
  - "pico"
  - "pidstat"
  - "ping"
  - "ping6"
  - "pip"
  - "pkexec"
  - "pkg"
  - "posh"
  - "pppd"
  - "pr"
  - "pry"
  - "psad"
  - "psftp"
  - "psql"
  - "ptx"
  - "puppet"
  - "pwsh"
  - "python"
  - "rake"
  - "rbash"
  - "rc"
  - "readelf"
  - "red"
  - "redcarpet"
  - "redis"
  - "restic"
  - "rev"
  - "rlogin"
  - "rlwrap"
  - "rpm"
  - "rpmdb"
  - "rpmquery"
  - "rpmverify"
  - "rsync"
  - "rtorrent"
  - "ruby"
  - "run-mailcap"
  - "run-parts"
  - "runscript"
  - "rview"
  - "rvim"
  - "sash"
  - "scanmem"
  - "scp"
  - "screen"
  - "script"
  - "scrot"
  - "sed"
  - "service"
  - "setarch"
  - "setfacl"
  - "setlock"
  - "sftp"
  - "sg"
  - "sh"
  - "shuf"
  - "slsh"
  - "smbclient"
  - "snap"
  - "socat"
  - "socket"
  - "soelim"
  - "softlimit"
  - "sort"
  - "split"
  - "sqlite3"
  - "sqlmap"
  - "ss"
  - "ssh"
  - "ssh-agent"
  - "ssh-keygen"
  - "ssh-keyscan"
  - "sshpass"
  - "start-stop-daemon"
  - "stdbuf"
  - "strace"
  - "strings"
  - "su"
  - "sysctl"
  - "systemctl"
  - "systemd-resolve"
  - "tac"
  - "tail"
  - "tar"
  - "task"
  - "taskset"
  - "tasksh"
  - "tbl"
  - "tclsh"
  - "tcpdump"
  - "tcsh"
  - "tdbtool"
  - "tee"
  - "telnet"
  - "terraform"
  - "tex"
  - "tftp"
  - "tic"
  - "time"
  - "timedatectl"
  - "timeout"
  - "tmate"
  - "tmux"
  - "top"
  - "torify"
  - "torsocks"
  - "traceroute6.iputils"
  - "troff"
  - "tshark"
  - "ul"
  - "umount"
  - "unexpand"
  - "uniq"
  - "unshare"
  - "unsquashfs"
  - "unzip"
  - "update-alternatives"
  - "uudecode"
  - "uuencode"
  - "vagrant"
  - "valgrind"
  - "varnishncsa"
  - "vi"
  - "view"
  - "vigr"
  - "vim"
  - "vimdiff"
  - "vipw"
  - "virsh"
  - "volatility"
  - "w3m"
  - "wall"
  - "watch"
  - "wc"
  - "wget"
  - "whiptail"
  - "whois"
  - "wireshark"
  - "wish"
  - "write"
  - "xargs"
  - "xdg-user-dir"
  - "xdotool"
  - "xelatex"
  - "xetex"
  - "xmodmap"
  - "xmore"
  - "xpad"
  - "xxd"
  - "xz"
  - "yarn"
  - "yash"
  - "yelp"
  - "yum"
  - "zathura"
  - "zip"
  - "zsh"
  - "zsoelim"
  - "zypper"
# AppArmor sysctl configuration template location.
sysctl_apparmor_config_template: "etc/sysctl/sysctl.apparmor.conf.j2"

# Sets the sysctl configuration directory.
sysctl_conf_dir: "{{ '/usr/lib/sysctl.d' if usr_lib_sysctl_d_dir else '/etc/sysctl.d' }}"

# If 0, restrict loading TTY line disciplines to the CAP_SYS_MODULE capability.
sysctl_dev_tty_ldisc_autoload: 0

# IPv6 sysctl configuration template location.
sysctl_ipv6_config_template: "etc/sysctl/sysctl.ipv6.conf.j2"

# main sysctl configuration template location.
sysctl_main_config_template: "etc/sysctl/sysctl.main.conf.j2"

# If 0, the system denies IPv6 router solicitations.
sysctl_net_ipv6_conf_accept_ra_rtr_pref: 0

# systemd system.conf template location.
system_conf_template: "etc/systemd/system.conf.j2"

# If True, then the system will be upgraded to the latest version using C(apt) or C(dnf).
system_upgrade: true

# systemd timesyncd.conf template location.
timesyncd_conf_template: "etc/systemd/timesyncd.conf.j2"

# tmp.mount template location.
tmp_mount_template: "etc/systemd/tmp.mount.j2"

# Allowed outgoing ports and protocols.
ufw_outgoing_traffic:
  - { "port": 22, "proto": "tcp" }
  - 53
  - { "port": 80, "proto": "tcp" }
  - { "port": 123, "proto": "udp" }
  - { "port": 443, "proto": "tcp" }
  - 853
  - { "port": 4460, "proto": "tcp" }
# If True, rate limiting is enabled for incoming connections.
ufw_rate_limit: false

# Sets the default umask value.
umask_value: "0077"

# APT unattended-upgrades for custom origins template location.
unattended_upgrades_custom_origins_template: "etc/apt/apt.conf.d/53unattended-upgrades-custom-origins.j2"

# APT unattended-upgrades template location.
unattended_upgrades_template: "etc/apt/apt.conf.d/52unattended-upgrades-local.j2"

# USBGuard audit events log backend.
usbguard_auditbackend: "LinuxAudit"

# USBGuard audit events log file path.
usbguard_auditfilepath: "/var/log/usbguard/usbguard-audit.log"

# Default authorized controller devices.
usbguard_authorizeddefault: "none"

# USBGuard configuration file path.
usbguard_configuration_file: "/etc/usbguard/usbguard-daemon.conf"

# Which device manager backend implementation to use.
usbguard_devicemanagerbackend: "uevent"

# Generate device specific rules including the 'via-port' attribute.
usbguard_deviceruleswithport: false

# Hide personally identifiable information such as device serial numbers and hashes of descriptors from audit entries.
usbguard_hidepii: false

# How to treat USB devices that don’t match any rule in the policy.
usbguard_implicitpolicytarget: "block"

# How to treat USB devices that are already connected after the daemon starts.
usbguard_inserteddevicepolicy: "apply-policy"

# The files at this location will be interpreted by the daemon as IPC access control definition files.
usbguard_ipcaccesscontrolfiles: "/etc/usbguard/IPCAccessControl.d/"

# A list of groupnames that the daemon will accept IPC connections from.
usbguard_ipcallowedgroups: ["plugdev", "root", "wheel"]
# A list of usernames that the daemon will accept IPC connections from.
usbguard_ipcallowedusers: ["root"]
# How to treat USB controller devices that are already connected when the daemon starts.
usbguard_presentcontrollerpolicy: "keep"

# How to treat USB devices that are already connected when the daemon starts.
usbguard_presentdevicepolicy: "apply-policy"

# Control whether the daemon will try to restore the attribute values to the state before modification on shutdown.
usbguard_restorecontrollerdevicestate: false

# USBGuard rule file path.
usbguard_rulefile: "/etc/usbguard/rules.conf"

# systemd user.conf template location.
user_conf_template: "etc/systemd/user.conf.j2"

# useradd template location.
useradd_template: "etc/default/useradd.j2"

# If True, use C(/usr/lib/sysctl.d) as the sysctl configuration directory, otherwise use C(/etc/sysctl.d).
usr_lib_sysctl_d_dir: false
